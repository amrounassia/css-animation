<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">

<link rel="stylesheet" href="css/style.css">

<link href='//fonts.googleapis.com/css?family=Lobster' rel='stylesheet' type='text/css'>

<script src="js/libs/modernizr.min.js"></script>
<script src="js/libs/jquery.min.js"></script>
<script src="js/libs/jquery.appear-1.1.1.modified.js"></script>

<script>
	if (Modernizr.csstransitions) {
		function preloadImages(imgs, callback) {
			var cache = [],
				imgsTotal = imgs.length,
				imgsLoaded = 0;
	
			$(imgs).each(function (i, img) {
				var cacheImage = document.createElement('img');
				cacheImage.onload = function () {
					if (++imgsLoaded == imgsTotal) callback();
				};
				cacheImage.src = $(img).attr('src');
				cache.push(cacheImage);
			});
		};
		$.fn.trans = function () {
			var t = arguments[0],
				d = arguments[1] || '';
			if (t) {
				$.each(this, function (i, e) {
					$(['-webkit-', '-moz-', '-o-', '-ms-', '']).each(function (i, p) {
						$(e).css(p + 'transition' + d, t);
					});
				});
			}
		};

		document.write('<link rel="stylesheet" href="css/animation.css" />');
			
		$(function(){
			//preload images contained within elements that need to animate
			preloadImages($('#blocks .module img'), function () {
				$('#blocks').appear({
					once: true,
					forEachVisible: function (i, e) {
						$(e).data('delay', i);
					},
					appear: function () {
						var delay = 250,
							stagger = 800,
							sequential_delay = stagger * parseInt($(this).data('delay')) || 0;
	
						$(this).children().each(function (i, e) {
							$(e).trans(i * delay + sequential_delay + 'ms', '-delay');
						});
						$(this).removeClass('fadeIn');
					}
				});
			});
		});
	}
</script>

<title>Css animation test</title>

</head>
<body>
	<div id="wrapper">
		<section>
			<article>
				<h1>Css animation test</h1>

				<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Id, molestiae accusantium rem et impedit similique possimus expedita eveniet in quo. Vel, laudantium sint odit porro sunt blanditiis et aut dolorum rem earum cumque eligendi optio quisquam ea nostrum adipisci fugit.</p>
				<p>Velit, voluptas recusandae tenetur obcaecati amet harum a ut porro aspernatur dolorem fugiat quia error illo officiis natus ipsam veritatis animi ducimus dolore autem consequuntur iure iste quas rerum ullam voluptates nemo debitis voluptate deleniti laboriosam hic consectetur quae reprehenderit.</p>
				<p>Nam, porro, laboriosam, ex, aspernatur obcaecati amet a velit minus dolores laudantium facere aliquid explicabo iste pariatur error culpa odio illo. Suscipit, a, ea, enim, cum ut iste repellendus eveniet assumenda voluptatum iusto repudiandae repellat recusandae aliquam neque corporis architecto!</p>
				<p>Reprehenderit, possimus, at quam ut explicabo repellat reiciendis dolorem? Eveniet, porro, deserunt velit labore veritatis placeat accusamus maxime aperiam minus sequi recusandae ea neque? Exercitationem, expedita, tenetur, amet, ea corrupti in quis maxime magnam dolores rem similique nihil soluta nesciunt!</p>

				<ul>
					<li>Based on <a href="http://www.creativebloq.com/css3/getting-css-animations-trigger-1132906">this article by CreativeBloq.com &#8594; Getting CSS animations to trigger at the right time</a></li>
					<li>See a working <a href="_demo/">_demo/</a></li>
				</ul>
			</article>
		</section>

		<hr>

		<p>
			<button id="showAnimation">Toggle</button>
		</p>

		<section id="blocks">
			<div class="module">
				<p>
					<img src="http://placehold.it/145x62" alt="">
					<h4>Great expectations</h4>
					Lorem ipsum dolor sit amet, consectetur adipisicing elit. Fuga, recusandae tenetur vel sequi harum quam quaerat est doloremque! Odit, voluptatum!
				</p>
			</div>

			<div class="module">
				<p>
					<img src="http://placehold.it/145x62" alt="">
					<h4>Great findings</h4>
					Lorem ipsum dolor sit amet, consectetur adipisicing elit. Fuga, recusandae tenetur vel sequi harum quam quaerat est doloremque! Odit, voluptatum!
				</p>
			</div>

			<div class="module">
				<p>
					<img src="http://placehold.it/145x62" alt="">
					<h4>Great animation</h4>
					Lorem ipsum dolor sit amet, consectetur adipisicing elit. Fuga, recusandae tenetur vel sequi harum quam quaerat est doloremque! Odit, voluptatum!
				</p>
			</div>
		</section>	

		<hr>

		<article>
			<p>Consectetur, sint, quibusdam, consequatur ratione a error quae doloremque animi in laudantium nam sed provident ipsam? Eius, ab, quidem, eveniet reprehenderit sapiente qui quam explicabo dolor illum dolorum nostrum aliquid culpa ratione. Eaque ipsum corporis sit ut repudiandae adipisci asperiores.</p>
			<p>Magni, eveniet, dolor debitis atque error tempora officiis deserunt explicabo fugiat sapiente repudiandae voluptas hic a odit consequuntur facilis laboriosam esse aspernatur voluptatem et ducimus accusamus inventore vero? Dolores libero sapiente perferendis fugiat blanditiis temporibus explicabo fugit sunt doloremque labore.</p>
			<p>Quam, incidunt, esse nisi commodi odit quidem dolorum dicta tempore nobis voluptates. Vel, saepe, eius, laudantium minus sit perferendis tempore earum sed obcaecati adipisci minima inventore dolor laborum error sint dolore aliquam iusto suscipit at alias provident magnam itaque illum.</p>
			<p>Eos, laboriosam optio aspernatur fugiat minus similique praesentium consequatur facilis architecto officia? Facere, aspernatur, at eum est velit debitis ut consequuntur atque autem laboriosam cumque dolores vel provident eius libero adipisci sint. Aut, ipsum quam necessitatibus enim suscipit in reprehenderit!</p>
		</article>

		<hr>
	</div>
</body>

<script>
	$(document).ready(function(){
		$('#showAnimation').on('click', function(){
			$('#blocks .module').toggleClass('fadeIn');
			console.log('clicked');
		});
	});
</script>

</html>